# ガバナンスの提案

まれな状況では、非常に価値のあるクライアントが制御不能のためにフリーズする可能性があります
状況。非常に価値のあるクライアントでは、何百ものチャネルがアクティブに使用されている可能性があります。
これらのチャネルの一部には、ICS20に使用される大量のロックされたトークンが含まれている場合があります。

クライアントが表すチェーンのバリデーターセットの3分の1が共謀することを決定した場合、
彼らは、それぞれが他の3分の1によって署名された2つの有効であるが競合するヘッダーを承認することができます
正直なバリデーターセットの。ライトクライアントは、2つの有効な、しかし競合するもので更新できるようになりました
同じ高さのヘッダー。ライトクライアントは、どのヘッダーが信頼できるかを知ることができないため、
そのような不正行為の証拠が提出される可能性が高く、結果としてクライアントがフリーズします。

凍結されたライトクライアントは、ガバナンスの提案を介する場合を除いて、どのような状況でも更新できません。
バリデーターのクォーラムは、有効な実行ではない可能性のある任意の状態ルートに署名できるため
ステートマシンの場合、解凍の複雑さを緩和するためにガバナンス提案が追加されました
または「スタック」したクライアントを更新します。このメカニズムがなければ、バリデーターセットが必要になります
クライアントのフリーズを解除するための状態ルートを構築します。クライアントのフリーズを解除し、すべてのチャネルを再度有効にします
そのクライアントに基づいて構築されています。これにより、失われた資金が回収される可能性があります。

テンダーミントライトのクライアントは、信頼期間が経過した場合、期限切れになる可能性があります
最後の更新。これは、リレーがクライアントを更新するためのヘッダーの送信を停止した場合に発生する可能性があります。

カウンターパーティチェーンによる計画外のアップグレードも、クライアントの有効期限が切れる可能性があります。カウンターパーティの場合
チェーンが計画外のアップグレードを受けた場合、バリデーターによって署名されたそのアップグレードへのコミットメントがない可能性があります
チェーンIDが変更される前に設定されます。この状況では、の最後の有効な更新のバリデーターセット
チェーンIDが変更されたため、ライトクライアントが別の有効なヘッダーを生成することは期待されません。
最終的に、オンチェーンライトクライアントが期限切れになるように導きます。

価値の高いライトクライアントがフリーズ、期限切れ、または更新不可にされた場合、
サブジェクトクライアントと呼ばれるこのクライアントを更新するために、ガバナンス提案を提出することができます。 The
提案には、サブジェクトのクライアントIDと代替のクライアントIDが含まれます
クライアント。ライトクライアントの実装では、カスタム更新ロジックを実装できますが、ほとんどの場合、
提案が通過した場合、サブジェクトは代替クライアントの最新のコンセンサス状態に更新されます。
代理クライアントは、対象が裁判にかけられている間、「代役」として使用されます。作成することをお勧めします
代替クライアントも凍結されるのを避けるために、サブジェクトが凍結された*後*。
アクティブな代理クライアントは、投票期間中にヘッダーを送信して、偶発的な期限切れを防ぐことができます
提案が通過したら。

# ガバナンス提案を使用して期限切れのクライアントを回復する方法

関連ドキュメントも参照してください:[ADR-026、IBCクライアント回復メカニズム](../architecture/adr-026-ibc-client-recovery-mechanisms.md)

### 前提条件
-チェーンはibc-go> = v1.1.0で更新されます。
-Tendermintライトクライアントのリカバリパラメータは `true`に設定されます(これにより、ガバナンス提案を使用できるかどうかが決まります)。リカバリパラメータが `false`に設定されている場合、リカバリにはカスタム移行コードが必要になります。
-同じカウンターパーティチェーンのアクティブクライアントのクライアント識別子。
-ガバナンス預金。

## 手順

### ステップ1

クライアントが予期された `chain-id`に接続されているかどうかを確認します。たとえば、Akashチェーンを表す期限切れのTendermintクライアントの場合、クライアントの状態を照会すると、クライアントの状態は次のようになります。 

```
{
  client_id: 07-tendermint-146
  client_state:
  '@type':/ibc.lightclients.tendermint.v1.ClientState
  allow_update_after_expiry: true
  allow_update_after_misbehaviour: true
  chain_id: akashnet-2
}
```

クライアントは予期されたAkashの `chain-id`に接続され、リカバリパラメータ(` allow_update_after_expiry`と `allow_update_after_misbehaviour`)は` true`に設定されます。

### ステップ2

チェーンがibc-go> = v1.1.0に更新されている場合、誰でもcliを介してこれを実行することにより、クライアントを回復するためのガバナンス提案を送信できます。

```
<binary> tx gov submit-proposal update-client <expired-client-id> <active-client-id>
```

`<active-client-id>`は、期限切れまたは凍結されたクライアントと同じチェーン上のクライアント識別子である必要があります。 このクライアント識別子は、期限切れまたは凍結されたクライアントと同じチェーンに接続する必要があります。 これは、2つのチェーン間でパケットを中継するために現在使用されているアクティブなクライアントを代替クライアントとして使用することを意味します。

この後、それは誰がガバナンス預金に資金を提供するか、そして問題のチェーンが賛成票を投じるかどうかの問題です。

## 重要な考慮事項

ibc-goのv1.0.0以降、期限切れのクライアントへのトランザクションの送信は許可されなくなることに注意してください。今後同様の問題が発生しないように、少なくともこのバージョンに更新してください。

また、トランザクションのもう一方の端にあるクライアントも期限切れになった場合、そのクライアントも更新する必要があることに注意してください。 このプロセスでは、1つのクライアントのみが更新されます。